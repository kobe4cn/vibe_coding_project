# =============================================================================
# FDL Runtime Environment Configuration
# =============================================================================
# Copy this file to .env and modify values as needed
# For production, ensure all security-related variables are properly configured

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------

# Server bind address (default: 0.0.0.0)
FDL_HOST=0.0.0.0

# Server port (default: 3001)
FDL_PORT=3001

# Development mode - enables dev features, relaxed security (default: true)
# IMPORTANT: Set to false in production!
FDL_DEV_MODE=true

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------

# PostgreSQL connection URL
# Format: postgres://user:password@host:port/database
# For SSL: postgres://user:password@host:port/database?sslmode=require
DATABASE_URL=postgres://postgres:postgres@localhost:5432/fdl_runtime

# Enable PostgreSQL storage (default: false, uses in-memory storage)
FDL_USE_DATABASE=true

# Database connection pool size (default: 10)
FDL_DB_POOL_SIZE=10

# Database connection timeout in seconds (default: 30)
FDL_DB_TIMEOUT=30

# -----------------------------------------------------------------------------
# Authentication & Security
# -----------------------------------------------------------------------------

# JWT signing secret - REQUIRED in production
# Generate with: openssl rand -base64 64
# Minimum 32 characters, recommended 64+ characters
FDL_JWT_SECRET=your-super-secret-jwt-key-change-this-in-production

# JWT access token TTL in seconds (default: 3600 = 1 hour)
FDL_JWT_ACCESS_TTL=3600

# JWT refresh token TTL in seconds (default: 604800 = 7 days)
FDL_JWT_REFRESH_TTL=604800

# JWT issuer claim (default: fdl-runtime)
FDL_JWT_ISSUER=fdl-runtime

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------

# Allowed origins (comma-separated, use * for development only)
FDL_CORS_ORIGINS=http://localhost:5173,http://localhost:3000

# Allow credentials in CORS requests (default: true)
FDL_CORS_CREDENTIALS=true

# CORS max age in seconds (default: 3600)
FDL_CORS_MAX_AGE=3600

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------

# Enable rate limiting (default: true in production)
FDL_RATE_LIMIT_ENABLED=false

# Requests per second per IP (default: 10)
FDL_RATE_LIMIT_RPS=10

# Rate limit burst size (default: 20)
FDL_RATE_LIMIT_BURST=20

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------

# Log level configuration
# Options: error, warn, info, debug, trace
# Format: crate=level,crate2=level2
RUST_LOG=fdl_runtime=debug,fdl_executor=debug,fdl_gml=info,tower_http=debug

# Log format: json or pretty (default: pretty for dev, json for prod)
FDL_LOG_FORMAT=pretty

# -----------------------------------------------------------------------------
# Execution Engine
# -----------------------------------------------------------------------------

# Maximum concurrent flow executions (default: 100)
FDL_MAX_CONCURRENT_EXECUTIONS=100

# Execution timeout in seconds (default: 300 = 5 minutes)
FDL_EXECUTION_TIMEOUT=300

# Enable execution history persistence (default: true)
FDL_PERSIST_EXECUTION_HISTORY=true

# Maximum execution history entries to keep per flow (default: 100)
FDL_MAX_EXECUTION_HISTORY=100

# -----------------------------------------------------------------------------
# WebSocket Configuration
# -----------------------------------------------------------------------------

# WebSocket heartbeat interval in seconds (default: 30)
FDL_WS_HEARTBEAT_INTERVAL=30

# WebSocket connection timeout in seconds (default: 60)
FDL_WS_TIMEOUT=60

# Maximum WebSocket message size in bytes (default: 1048576 = 1MB)
FDL_WS_MAX_MESSAGE_SIZE=1048576

# -----------------------------------------------------------------------------
# Tool Handlers
# -----------------------------------------------------------------------------

# HTTP client timeout for API calls in seconds (default: 30)
FDL_HTTP_TIMEOUT=30

# Maximum retries for failed API calls (default: 3)
FDL_HTTP_MAX_RETRIES=3

# MCP server connection timeout in seconds (default: 10)
FDL_MCP_TIMEOUT=10

# -----------------------------------------------------------------------------
# Multi-Tenancy
# -----------------------------------------------------------------------------

# Default tenant ID for development (only used when FDL_DEV_MODE=true)
FDL_DEFAULT_TENANT_ID=00000000-0000-0000-0000-000000000000

# Enable tenant isolation checks (default: true)
FDL_TENANT_ISOLATION=true

# -----------------------------------------------------------------------------
# Audit Logging
# -----------------------------------------------------------------------------

# Enable audit logging (default: true)
FDL_AUDIT_ENABLED=true

# Audit log retention days (default: 90)
FDL_AUDIT_RETENTION_DAYS=90

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------

# Enable Swagger UI (default: true in dev, false in prod)
FDL_SWAGGER_ENABLED=true

# Enable detailed error messages in responses (default: true in dev)
FDL_DETAILED_ERRORS=true

# Enable request/response logging (default: true in dev)
FDL_REQUEST_LOGGING=true
